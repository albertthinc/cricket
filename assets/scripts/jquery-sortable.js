!function(e,t,n){function f(e,t){var n=Math.max(0,e[0]-t[0],t[0]-e[1]),r=Math.max(0,e[2]-t[1],t[1]-e[3]);return n+r}function l(e,t,n){var r=e.slice((n||t)+1||e.length);e.length=t<0?e.length+t:t;return e.push.apply(e,r)}function c(t,n,r){var i=t.length,s=r?"offset":"position";while(i--){var o=t[i].el?t[i].el:e(t[i]),u=o[s]();n[i]=[u.left,u.left+o.outerWidth(true),u.top,u.top+o.outerHeight(true)]}}function h(e,t){var n=t.offset();return{left:e.left-n.left,top:e.top-n.top}}function p(e,t,n){t=[t.left,t.top];n=n&&[n.left,n.top];var r,i=e.length,s=[];while(i--){r=e[i];s[i]=[i,f(r,t),n&&f(r,n)]}s=s.sort(function(e,t){return t[1]-e[1]||t[2]-e[2]||t[0]-e[0]});return s}function d(e,t,n,r){var s=e.find(t),o=s.length;while(o--){var u=s.eq(o).data(i);if(u)u[n](r)}}function v(t){this.options=e.extend({},o,t);this.containers=[];this.childGroups=[];this.scrolledProxy=e.proxy(this.scrolled,this);this.dragProxy=e.proxy(this.drag,this);this.dropProxy=e.proxy(this.drop,this);if(this.options.parentGroup)this.options.parentGroup.childGroups.push(this);else{this.placeholder=e(this.options.placeholder);if(!t.isValidTarget)this.options.isValidTarget=n}}function m(t,n){this.el=t;this.childGroups=[];this.floatRight=false;this.dragInitProxy=e.proxy(this.dragInit,this);this.options=e.extend({},s,n);this.group=v.get(this.options);this.rootGroup=this.options.rootGroup=this.options.rootGroup||this.group;this.parentGroup=this.options.parentGroup=this.options.parentGroup||this.group;this.handle=this.rootGroup.options.handle||this.rootGroup.options.itemSelector;this.enable(true)}var r,i="sortable",s={drag:true,drop:true,exclude:"",nested:true,vertical:true},o={afterMove:function(e,t){},containerSelector:"ol, ul",distance:0,handle:"",itemSelector:"li",isValidTarget:function(e,t){return true},onCancel:function(e,t,n){},onDrag:function(e,t,n){e.css(t)},onDragStart:function(t,n,r){t.css({height:t.height(),width:t.width()});t.addClass("dragged");e("body").addClass("dragging")},onDrop:function(t,n,r){t.removeClass("dragged").removeAttr("style");e("body").removeClass("dragging")},onMousedown:function(e,t,n){t.preventDefault()},placeholder:'<li class="placeholder"/>',pullPlaceholder:true,serialize:function(t,n,r){var i=e.extend({},t.data());if(r)return n;else if(n[0]){i.children=n;delete i.subContainer}delete i.sortable;return i},tolerance:0},u={},a=0;if("ontouchstart"in t){r={start:"touchstart.sortable",end:"touchend.sortable touchcancel.sortable",move:"touchmove.sortable"}}else{r={start:"mousedown.sortable",end:"mouseup.sortable",move:"mousemove.sortable"}}v.get=function(e){if(!u[e.group]){if(!e.group)e.group=a++;u[e.group]=new v(e)}return u[e.group]};v.prototype={dragInit:function(t,n){this.$document=e(n.el[0].ownerDocument);this.toggleListeners("on");this.item=e(t.target).closest(this.options.itemSelector);this.itemContainer=n;this.setPointer(t);this.options.onMousedown(this.item,t,o.onMousedown)},drag:function(e){if(!this.dragging){if(!this.distanceMet(e))return;d(this.item,this.options.containerSelector,"disable",true);this.options.onDragStart(this.item,this.itemContainer,o.onDragStart);this.item.before(this.placeholder);this.dragging=true}this.setPointer(e);this.options.onDrag(this.item,h(this.pointer,this.item.offsetParent()),o.onDrag);var t=e.pageX,n=e.pageY,r=this.sameResultBox,i=this.options.tolerance;if(!r||r.top-i>n||r.bottom+i<n||r.left-i>t||r.right+i<t)if(!this.searchValidTarget())this.placeholder.detach()},drop:function(e){this.toggleListeners("off");if(this.dragging){if(this.placeholder.closest("html")[0])this.placeholder.before(this.item).detach();else this.options.onCancel(this.item,this.itemContainer,o.onCancel);this.options.onDrop(this.item,this.getContainer(this.item),o.onDrop);d(this.item,this.options.containerSelector,"enable",true);this.clearDimensions();this.clearOffsetParent();this.lastAppendedItem=this.sameResultBox=n;this.dragging=false}this.item=n},searchValidTarget:function(e,t){if(!e){e=this.relativePointer||this.pointer;t=this.lastRelativePointer||this.lastPointer}var n=p(this.getContainerDimensions(),e,t),r=n.length;while(r--){var i=n[r][0],s=n[r][1];if(!s||this.options.pullPlaceholder){var o=this.containers[i];if(!this.$getOffsetParent()){var u=o.getItemOffsetParent();e=h(e,u);t=h(t,u)}if(o.searchValidTarget(e,t))return true}}},movePlaceholder:function(e,t,n,r){var i=this.lastAppendedItem;if(!r&&i&&i[0]===t[0])return;t[n](this.placeholder);this.lastAppendedItem=t;this.sameResultBox=r;this.options.afterMove(this.placeholder,e)},getContainerDimensions:function(){if(!this.containerDimensions)c(this.containers,this.containerDimensions=[],!this.$getOffsetParent());return this.containerDimensions},getContainer:function(e){return e.closest(this.options.containerSelector).data(i)},$getOffsetParent:function(){if(this.offsetParent===n){var e=this.containers.length-1,t=this.containers[e].getItemOffsetParent();if(!this.options.parentGroup){while(e--){if(t[0]!=this.containers[e].getItemOffsetParent()[0]){t=false;break}}}this.offsetParent=t}return this.offsetParent},clearOffsetParent:function(){this.offsetParent=n},setPointer:function(e){var t={left:e.pageX,top:e.pageY};if(this.$getOffsetParent()){var n=h(t,this.$getOffsetParent());this.lastRelativePointer=this.relativePointer;this.relativePointer=n}this.lastPointer=this.pointer;this.pointer=t},distanceMet:function(e){return Math.max(Math.abs(this.pointer.left-e.pageX),Math.abs(this.pointer.top-e.pageY))>=this.options.distance},addContainer:function(e){this.containers.push(e)},removeContainer:function(t){var n=e.inArray(t,this.containers);n!==-1&&l(this.containers,n)},scrolled:function(e){this.clearDimensions();this.clearOffsetParent()},toggleListeners:function(e){this.$document[e](r.move,this.dragProxy)[e](r.end,this.dropProxy)[e]("scroll.sortable",this.scrolledProxy)},clearDimensions:function(){this.containerDimensions=n;var e=this.containers.length;while(e--){this.containers[e].itemDimensions=n}e=this.childGroups.length;while(e--){this.childGroups[e].clearDimensions()}}};m.prototype={dragInit:function(t){var n=this.rootGroup;if(!n.item&&t.which===1&&this.options.drag&&!e(t.target).is(this.options.exclude))n.dragInit(t,this)},searchValidTarget:function(e,t){var n=p(this.getItemDimensions(),e,t),r=n.length,i=this.rootGroup,s=!i.options.isValidTarget||i.options.isValidTarget(i.item,this);if(!r&&s){i.movePlaceholder(this,this.el,"append");return true}else while(r--){var o=n[r][0],u=n[r][1];if(!u&&this.options.nested&&this.getContainerGroup(o)){var a=this.getContainerGroup(o).searchValidTarget(e,t);if(a)return true}else if(s){this.movePlaceholder(o,e);return true}}},movePlaceholder:function(t,n){var r=e(this.items[t]),i=this.itemDimensions[t],s="after",o=r.outerWidth(),u=r.outerHeight(),a=r.offset(),f={left:a.left,right:a.left+o,top:a.top,bottom:a.top+u};if(this.options.vertical){var l=(i[2]+i[3])/2,c=n.top<=l;if(c){s="before";f.bottom-=u/2}else f.top+=u/2}else{var h=(i[0]+i[1])/2,p=n.left<=h;if(p!=this.floatRight){s="before";f.right-=o/2}else f.left+=o/2}this.rootGroup.movePlaceholder(this,r,s,f)},getItemDimensions:function(){if(!this.itemDimensions){this.items=this.$getChildren(this.el,"item").filter(":not(.dragged)").get();c(this.items,this.itemDimensions=[])}return this.itemDimensions},getItemOffsetParent:function(){var e,t=this.el;if(t.css("position")==="relative"||t.css("position")==="absolute"||t.css("position")==="fixed")e=t;else e=t.offsetParent();return e},getContainerGroup:function(t){var r=e.data(this.items[t],"subContainer");if(r===n){var s=this.$getChildren(this.items[t],"container");r=false;if(s[0]){var o=e.extend({},this.options,{parentGroup:this.group,group:a++});r=s[i](o).data(i).group}e.data(this.items[t],"subContainer",r)}return r},$getChildren:function(t,n){return e(t).children(this.rootGroup.options[n+"Selector"])},_serialize:function(t,n){var r=this,i=n?"item":"container",s=this.$getChildren(t,i).not(this.options.exclude).map(function(){return r._serialize(e(this),!n)}).get();return this.rootGroup.options.serialize(t,s,n)}};var g={enable:function(e){if(this.options.drop)this.group.addContainer(this);if(!e)d(this.el,this.options.containerSelector,"enable",true);this.el.on(r.start,this.handle,this.dragInitProxy)},disable:function(e){if(this.options.drop)this.group.removeContainer(this);if(!e)d(this.el,this.options.containerSelector,"disable",true);this.el.off(r.start)},serialize:function(){return this._serialize(this.el,true)}};e.extend(m.prototype,g);e.fn[i]=function(t){var r=Array.prototype.slice.call(arguments,1);return this.map(function(){var s=e(this),o=s.data(i);if(o&&g[t])return g[t].apply(o,r)||this;else if(!o&&(t===n||typeof t==="object"))s.data(i,new m(s,t));return this})}}(jQuery,window);!function(e,t,n){function f(e,t){var n=Math.max(0,e[0]-t[0],t[0]-e[1]),r=Math.max(0,e[2]-t[1],t[1]-e[3]);return n+r}function l(e,t,n){var r=e.slice((n||t)+1||e.length);e.length=t<0?e.length+t:t;return e.push.apply(e,r)}function c(t,n,r){var i=t.length,s=r?"offset":"position";while(i--){var o=t[i].el?t[i].el:e(t[i]),u=o[s]();n[i]=[u.left,u.left+o.outerWidth(true),u.top,u.top+o.outerHeight(true)]}}function h(e,t){var n=t.offset();return{left:e.left-n.left,top:e.top-n.top}}function p(e,t,n){t=[t.left,t.top];n=n&&[n.left,n.top];var r,i=e.length,s=[];while(i--){r=e[i];s[i]=[i,f(r,t),n&&f(r,n)]}s=s.sort(function(e,t){return t[1]-e[1]||t[2]-e[2]||t[0]-e[0]});return s}function d(e,t,n,r){var s=e.find(t),o=s.length;while(o--){var u=s.eq(o).data(i);if(u)u[n](r)}}function v(t){this.options=e.extend({},o,t);this.containers=[];this.childGroups=[];this.scrolledProxy=e.proxy(this.scrolled,this);this.dragProxy=e.proxy(this.drag,this);this.dropProxy=e.proxy(this.drop,this);if(this.options.parentGroup)this.options.parentGroup.childGroups.push(this);else{this.placeholder=e(this.options.placeholder);if(!t.isValidTarget)this.options.isValidTarget=n}}function m(t,n){this.el=t;this.childGroups=[];this.floatRight=false;this.dragInitProxy=e.proxy(this.dragInit,this);this.options=e.extend({},s,n);this.group=v.get(this.options);this.rootGroup=this.options.rootGroup=this.options.rootGroup||this.group;this.parentGroup=this.options.parentGroup=this.options.parentGroup||this.group;this.handle=this.rootGroup.options.handle||this.rootGroup.options.itemSelector;this.enable(true)}var r,i="sortable",s={drag:true,drop:true,exclude:"",nested:true,vertical:true},o={afterMove:function(e,t){},containerSelector:"ol, ul",distance:0,handle:"",itemSelector:"li",isValidTarget:function(e,t){return true},onCancel:function(e,t,n){},onDrag:function(e,t,n){e.css(t)},onDragStart:function(t,n,r){t.css({height:t.height(),width:t.width()});t.addClass("dragged");e("body").addClass("dragging")},onDrop:function(t,n,r){t.removeClass("dragged").removeAttr("style");e("body").removeClass("dragging")},onMousedown:function(e,t,n){t.preventDefault()},placeholder:'<li class="placeholder"/>',pullPlaceholder:true,serialize:function(t,n,r){var i=e.extend({},t.data());if(r)return n;else if(n[0]){i.children=n;delete i.subContainer}delete i.sortable;return i},tolerance:0},u={},a=0;if("ontouchstart"in t){r={start:"touchstart.sortable",end:"touchend.sortable touchcancel.sortable",move:"touchmove.sortable"}}else{r={start:"mousedown.sortable",end:"mouseup.sortable",move:"mousemove.sortable"}}v.get=function(e){if(!u[e.group]){if(!e.group)e.group=a++;u[e.group]=new v(e)}return u[e.group]};v.prototype={dragInit:function(t,n){this.$document=e(n.el[0].ownerDocument);this.toggleListeners("on");this.item=e(t.target).closest(this.options.itemSelector);this.itemContainer=n;this.setPointer(t);this.options.onMousedown(this.item,t,o.onMousedown)},drag:function(e){if(!this.dragging){if(!this.distanceMet(e))return;d(this.item,this.options.containerSelector,"disable",true);this.options.onDragStart(this.item,this.itemContainer,o.onDragStart);this.item.before(this.placeholder);this.dragging=true}this.setPointer(e);this.options.onDrag(this.item,h(this.pointer,this.item.offsetParent()),o.onDrag);var t=e.pageX,n=e.pageY,r=this.sameResultBox,i=this.options.tolerance;if(!r||r.top-i>n||r.bottom+i<n||r.left-i>t||r.right+i<t)if(!this.searchValidTarget())this.placeholder.detach()},drop:function(e){this.toggleListeners("off");if(this.dragging){if(this.placeholder.closest("html")[0])this.placeholder.before(this.item).detach();else this.options.onCancel(this.item,this.itemContainer,o.onCancel);this.options.onDrop(this.item,this.getContainer(this.item),o.onDrop);d(this.item,this.options.containerSelector,"enable",true);this.clearDimensions();this.clearOffsetParent();this.lastAppendedItem=this.sameResultBox=n;this.dragging=false}this.item=n},searchValidTarget:function(e,t){if(!e){e=this.relativePointer||this.pointer;t=this.lastRelativePointer||this.lastPointer}var n=p(this.getContainerDimensions(),e,t),r=n.length;while(r--){var i=n[r][0],s=n[r][1];if(!s||this.options.pullPlaceholder){var o=this.containers[i];if(!this.$getOffsetParent()){var u=o.getItemOffsetParent();e=h(e,u);t=h(t,u)}if(o.searchValidTarget(e,t))return true}}},movePlaceholder:function(e,t,n,r){var i=this.lastAppendedItem;if(!r&&i&&i[0]===t[0])return;t[n](this.placeholder);this.lastAppendedItem=t;this.sameResultBox=r;this.options.afterMove(this.placeholder,e)},getContainerDimensions:function(){if(!this.containerDimensions)c(this.containers,this.containerDimensions=[],!this.$getOffsetParent());return this.containerDimensions},getContainer:function(e){return e.closest(this.options.containerSelector).data(i)},$getOffsetParent:function(){if(this.offsetParent===n){var e=this.containers.length-1,t=this.containers[e].getItemOffsetParent();if(!this.options.parentGroup){while(e--){if(t[0]!=this.containers[e].getItemOffsetParent()[0]){t=false;break}}}this.offsetParent=t}return this.offsetParent},clearOffsetParent:function(){this.offsetParent=n},setPointer:function(e){var t={left:e.pageX,top:e.pageY};if(this.$getOffsetParent()){var n=h(t,this.$getOffsetParent());this.lastRelativePointer=this.relativePointer;this.relativePointer=n}this.lastPointer=this.pointer;this.pointer=t},distanceMet:function(e){return Math.max(Math.abs(this.pointer.left-e.pageX),Math.abs(this.pointer.top-e.pageY))>=this.options.distance},addContainer:function(e){this.containers.push(e)},removeContainer:function(t){var n=e.inArray(t,this.containers);n!==-1&&l(this.containers,n)},scrolled:function(e){this.clearDimensions();this.clearOffsetParent()},toggleListeners:function(e){this.$document[e](r.move,this.dragProxy)[e](r.end,this.dropProxy)[e]("scroll.sortable",this.scrolledProxy)},clearDimensions:function(){this.containerDimensions=n;var e=this.containers.length;while(e--){this.containers[e].itemDimensions=n}e=this.childGroups.length;while(e--){this.childGroups[e].clearDimensions()}}};m.prototype={dragInit:function(t){var n=this.rootGroup;if(!n.item&&t.which===1&&this.options.drag&&!e(t.target).is(this.options.exclude))n.dragInit(t,this)},searchValidTarget:function(e,t){var n=p(this.getItemDimensions(),e,t),r=n.length,i=this.rootGroup,s=!i.options.isValidTarget||i.options.isValidTarget(i.item,this);if(!r&&s){i.movePlaceholder(this,this.el,"append");return true}else while(r--){var o=n[r][0],u=n[r][1];if(!u&&this.options.nested&&this.getContainerGroup(o)){var a=this.getContainerGroup(o).searchValidTarget(e,t);if(a)return true}else if(s){this.movePlaceholder(o,e);return true}}},movePlaceholder:function(t,n){var r=e(this.items[t]),i=this.itemDimensions[t],s="after",o=r.outerWidth(),u=r.outerHeight(),a=r.offset(),f={left:a.left,right:a.left+o,top:a.top,bottom:a.top+u};if(this.options.vertical){var l=(i[2]+i[3])/2,c=n.top<=l;if(c){s="before";f.bottom-=u/2}else f.top+=u/2}else{var h=(i[0]+i[1])/2,p=n.left<=h;if(p!=this.floatRight){s="before";f.right-=o/2}else f.left+=o/2}this.rootGroup.movePlaceholder(this,r,s,f)},getItemDimensions:function(){if(!this.itemDimensions){this.items=this.$getChildren(this.el,"item").filter(":not(.dragged)").get();c(this.items,this.itemDimensions=[])}return this.itemDimensions},getItemOffsetParent:function(){var e,t=this.el;if(t.css("position")==="relative"||t.css("position")==="absolute"||t.css("position")==="fixed")e=t;else e=t.offsetParent();return e},getContainerGroup:function(t){var r=e.data(this.items[t],"subContainer");if(r===n){var s=this.$getChildren(this.items[t],"container");r=false;if(s[0]){var o=e.extend({},this.options,{parentGroup:this.group,group:a++});r=s[i](o).data(i).group}e.data(this.items[t],"subContainer",r)}return r},$getChildren:function(t,n){return e(t).children(this.rootGroup.options[n+"Selector"])},_serialize:function(t,n){var r=this,i=n?"item":"container",s=this.$getChildren(t,i).not(this.options.exclude).map(function(){return r._serialize(e(this),!n)}).get();return this.rootGroup.options.serialize(t,s,n)}};var g={enable:function(e){if(this.options.drop)this.group.addContainer(this);if(!e)d(this.el,this.options.containerSelector,"enable",true);this.el.on(r.start,this.handle,this.dragInitProxy)},disable:function(e){if(this.options.drop)this.group.removeContainer(this);if(!e)d(this.el,this.options.containerSelector,"disable",true);this.el.off(r.start)},serialize:function(){return this._serialize(this.el,true)}};e.extend(m.prototype,g);e.fn[i]=function(t){var r=Array.prototype.slice.call(arguments,1);return this.map(function(){var s=e(this),o=s.data(i);if(o&&g[t])return g[t].apply(o,r)||this;else if(!o&&(t===n||typeof t==="object"))s.data(i,new m(s,t));return this})}}(jQuery,window);!function(e,t,n){function f(e,t){var n=Math.max(0,e[0]-t[0],t[0]-e[1]),r=Math.max(0,e[2]-t[1],t[1]-e[3]);return n+r}function l(e,t,n){var r=e.slice((n||t)+1||e.length);e.length=t<0?e.length+t:t;return e.push.apply(e,r)}function c(t,n,r){var i=t.length,s=r?"offset":"position";while(i--){var o=t[i].el?t[i].el:e(t[i]),u=o[s]();n[i]=[u.left,u.left+o.outerWidth(true),u.top,u.top+o.outerHeight(true)]}}function h(e,t){var n=t.offset();return{left:e.left-n.left,top:e.top-n.top}}function p(e,t,n){t=[t.left,t.top];n=n&&[n.left,n.top];var r,i=e.length,s=[];while(i--){r=e[i];s[i]=[i,f(r,t),n&&f(r,n)]}s=s.sort(function(e,t){return t[1]-e[1]||t[2]-e[2]||t[0]-e[0]});return s}function d(e,t,n,r){var s=e.find(t),o=s.length;while(o--){var u=s.eq(o).data(i);if(u)u[n](r)}}function v(t){this.options=e.extend({},o,t);this.containers=[];this.childGroups=[];this.scrolledProxy=e.proxy(this.scrolled,this);this.dragProxy=e.proxy(this.drag,this);this.dropProxy=e.proxy(this.drop,this);if(this.options.parentGroup)this.options.parentGroup.childGroups.push(this);else{this.placeholder=e(this.options.placeholder);if(!t.isValidTarget)this.options.isValidTarget=n}}function m(t,n){this.el=t;this.childGroups=[];this.floatRight=false;this.dragInitProxy=e.proxy(this.dragInit,this);this.options=e.extend({},s,n);this.group=v.get(this.options);this.rootGroup=this.options.rootGroup=this.options.rootGroup||this.group;this.parentGroup=this.options.parentGroup=this.options.parentGroup||this.group;this.handle=this.rootGroup.options.handle||this.rootGroup.options.itemSelector;this.enable(true)}var r,i="sortable",s={drag:true,drop:true,exclude:"",nested:true,vertical:true},o={afterMove:function(e,t){},containerSelector:"ol, ul",distance:0,handle:"",itemSelector:"li",isValidTarget:function(e,t){return true},onCancel:function(e,t,n){},onDrag:function(e,t,n){e.css(t)},onDragStart:function(t,n,r){t.css({height:t.height(),width:t.width()});t.addClass("dragged");e("body").addClass("dragging")},onDrop:function(t,n,r){t.removeClass("dragged").removeAttr("style");e("body").removeClass("dragging")},onMousedown:function(e,t,n){t.preventDefault()},placeholder:'<li class="placeholder"/>',pullPlaceholder:true,serialize:function(t,n,r){var i=e.extend({},t.data());if(r)return n;else if(n[0]){i.children=n;delete i.subContainer}delete i.sortable;return i},tolerance:0},u={},a=0;if("ontouchstart"in t){r={start:"touchstart.sortable",end:"touchend.sortable touchcancel.sortable",move:"touchmove.sortable"}}else{r={start:"mousedown.sortable",end:"mouseup.sortable",move:"mousemove.sortable"}}v.get=function(e){if(!u[e.group]){if(!e.group)e.group=a++;u[e.group]=new v(e)}return u[e.group]};v.prototype={dragInit:function(t,n){this.$document=e(n.el[0].ownerDocument);this.toggleListeners("on");this.item=e(t.target).closest(this.options.itemSelector);this.itemContainer=n;this.setPointer(t);this.options.onMousedown(this.item,t,o.onMousedown)},drag:function(e){if(!this.dragging){if(!this.distanceMet(e))return;d(this.item,this.options.containerSelector,"disable",true);this.options.onDragStart(this.item,this.itemContainer,o.onDragStart);this.item.before(this.placeholder);this.dragging=true}this.setPointer(e);this.options.onDrag(this.item,h(this.pointer,this.item.offsetParent()),o.onDrag);var t=e.pageX,n=e.pageY,r=this.sameResultBox,i=this.options.tolerance;if(!r||r.top-i>n||r.bottom+i<n||r.left-i>t||r.right+i<t)if(!this.searchValidTarget())this.placeholder.detach()},drop:function(e){this.toggleListeners("off");if(this.dragging){if(this.placeholder.closest("html")[0])this.placeholder.before(this.item).detach();else this.options.onCancel(this.item,this.itemContainer,o.onCancel);this.options.onDrop(this.item,this.getContainer(this.item),o.onDrop);d(this.item,this.options.containerSelector,"enable",true);this.clearDimensions();this.clearOffsetParent();this.lastAppendedItem=this.sameResultBox=n;this.dragging=false}this.item=n},searchValidTarget:function(e,t){if(!e){e=this.relativePointer||this.pointer;t=this.lastRelativePointer||this.lastPointer}var n=p(this.getContainerDimensions(),e,t),r=n.length;while(r--){var i=n[r][0],s=n[r][1];if(!s||this.options.pullPlaceholder){var o=this.containers[i];if(!this.$getOffsetParent()){var u=o.getItemOffsetParent();e=h(e,u);t=h(t,u)}if(o.searchValidTarget(e,t))return true}}},movePlaceholder:function(e,t,n,r){var i=this.lastAppendedItem;if(!r&&i&&i[0]===t[0])return;t[n](this.placeholder);this.lastAppendedItem=t;this.sameResultBox=r;this.options.afterMove(this.placeholder,e)},getContainerDimensions:function(){if(!this.containerDimensions)c(this.containers,this.containerDimensions=[],!this.$getOffsetParent());return this.containerDimensions},getContainer:function(e){return e.closest(this.options.containerSelector).data(i)},$getOffsetParent:function(){if(this.offsetParent===n){var e=this.containers.length-1,t=this.containers[e].getItemOffsetParent();if(!this.options.parentGroup){while(e--){if(t[0]!=this.containers[e].getItemOffsetParent()[0]){t=false;break}}}this.offsetParent=t}return this.offsetParent},clearOffsetParent:function(){this.offsetParent=n},setPointer:function(e){var t={left:e.pageX,top:e.pageY};if(this.$getOffsetParent()){var n=h(t,this.$getOffsetParent());this.lastRelativePointer=this.relativePointer;this.relativePointer=n}this.lastPointer=this.pointer;this.pointer=t},distanceMet:function(e){return Math.max(Math.abs(this.pointer.left-e.pageX),Math.abs(this.pointer.top-e.pageY))>=this.options.distance},addContainer:function(e){this.containers.push(e)},removeContainer:function(t){var n=e.inArray(t,this.containers);n!==-1&&l(this.containers,n)},scrolled:function(e){this.clearDimensions();this.clearOffsetParent()},toggleListeners:function(e){this.$document[e](r.move,this.dragProxy)[e](r.end,this.dropProxy)[e]("scroll.sortable",this.scrolledProxy)},clearDimensions:function(){this.containerDimensions=n;var e=this.containers.length;while(e--){this.containers[e].itemDimensions=n}e=this.childGroups.length;while(e--){this.childGroups[e].clearDimensions()}}};m.prototype={dragInit:function(t){var n=this.rootGroup;if(!n.item&&t.which===1&&this.options.drag&&!e(t.target).is(this.options.exclude))n.dragInit(t,this)},searchValidTarget:function(e,t){var n=p(this.getItemDimensions(),e,t),r=n.length,i=this.rootGroup,s=!i.options.isValidTarget||i.options.isValidTarget(i.item,this);if(!r&&s){i.movePlaceholder(this,this.el,"append");return true}else while(r--){var o=n[r][0],u=n[r][1];if(!u&&this.options.nested&&this.getContainerGroup(o)){var a=this.getContainerGroup(o).searchValidTarget(e,t);if(a)return true}else if(s){this.movePlaceholder(o,e);return true}}},movePlaceholder:function(t,n){var r=e(this.items[t]),i=this.itemDimensions[t],s="after",o=r.outerWidth(),u=r.outerHeight(),a=r.offset(),f={left:a.left,right:a.left+o,top:a.top,bottom:a.top+u};if(this.options.vertical){var l=(i[2]+i[3])/2,c=n.top<=l;if(c){s="before";f.bottom-=u/2}else f.top+=u/2}else{var h=(i[0]+i[1])/2,p=n.left<=h;if(p!=this.floatRight){s="before";f.right-=o/2}else f.left+=o/2}this.rootGroup.movePlaceholder(this,r,s,f)},getItemDimensions:function(){if(!this.itemDimensions){this.items=this.$getChildren(this.el,"item").filter(":not(.dragged)").get();c(this.items,this.itemDimensions=[])}return this.itemDimensions},getItemOffsetParent:function(){var e,t=this.el;if(t.css("position")==="relative"||t.css("position")==="absolute"||t.css("position")==="fixed")e=t;else e=t.offsetParent();return e},getContainerGroup:function(t){var r=e.data(this.items[t],"subContainer");if(r===n){var s=this.$getChildren(this.items[t],"container");r=false;if(s[0]){var o=e.extend({},this.options,{parentGroup:this.group,group:a++});r=s[i](o).data(i).group}e.data(this.items[t],"subContainer",r)}return r},$getChildren:function(t,n){return e(t).children(this.rootGroup.options[n+"Selector"])},_serialize:function(t,n){var r=this,i=n?"item":"container",s=this.$getChildren(t,i).not(this.options.exclude).map(function(){return r._serialize(e(this),!n)}).get();return this.rootGroup.options.serialize(t,s,n)}};var g={enable:function(e){if(this.options.drop)this.group.addContainer(this);if(!e)d(this.el,this.options.containerSelector,"enable",true);this.el.on(r.start,this.handle,this.dragInitProxy)},disable:function(e){if(this.options.drop)this.group.removeContainer(this);if(!e)d(this.el,this.options.containerSelector,"disable",true);this.el.off(r.start)},serialize:function(){return this._serialize(this.el,true)}};e.extend(m.prototype,g);e.fn[i]=function(t){var r=Array.prototype.slice.call(arguments,1);return this.map(function(){var s=e(this),o=s.data(i);if(o&&g[t])return g[t].apply(o,r)||this;else if(!o&&(t===n||typeof t==="object"))s.data(i,new m(s,t));return this})}}(jQuery,window)